{
  "hooks": {
    "SessionStart": [
      {
        "hooks": [
          {
            "type": "command",
            "command": "bash ${CLAUDE_PLUGIN_ROOT}/hooks/scripts/truth-beacon.sh",
            "timeout": 5,
            "statusMessage": "Loading authoritative facts..."
          }
        ]
      }
    ],
    "PreToolUse": [
      {
        "matcher": "Write|Edit",
        "hooks": [
          {
            "type": "command",
            "command": "bash ${CLAUDE_PLUGIN_ROOT}/hooks/scripts/epistemic-guard.sh",
            "timeout": 5,
            "statusMessage": "Checking epistemic constraints..."
          }
        ]
      },
      {
        "matcher": "Bash",
        "hooks": [
          {
            "type": "command",
            "command": "bash ${CLAUDE_PLUGIN_ROOT}/hooks/scripts/commit-integrity-hook.sh",
            "timeout": 10,
            "statusMessage": "Checking commit integrity..."
          }
        ]
      }
    ],
    "UserPromptSubmit": [
      {
        "hooks": [
          {
            "type": "command",
            "command": "bash ${CLAUDE_PLUGIN_ROOT}/hooks/scripts/struggle-inject.sh",
            "timeout": 3,
            "statusMessage": "Checking struggle state..."
          }
        ]
      }
    ],
    "Stop": [
      {
        "hooks": [
          {
            "type": "command",
            "command": "bash ${CLAUDE_PLUGIN_ROOT}/hooks/scripts/struggle-detector.sh",
            "timeout": 5,
            "async": true,
            "statusMessage": "Evaluating response quality..."
          }
        ]
      },
      {
        "hooks": [
          {
            "type": "prompt",
            "model": "haiku",
            "prompt": "You are a silent session observer. You see Claude's latest response. Extract what was just accomplished and what appears to remain. Output ONLY valid JSON: {\"systemMessage\":\"SESSION: [done] → [in progress] → [remaining]\"}. Keep the systemMessage under 30 words. If the response is trivial (greeting, short answer, single question), return {}.",
            "timeout": 10,
            "statusMessage": "Session observer..."
          }
        ]
      }
    ],
    "PostToolUse": [
      {
        "matcher": "Write|Edit",
        "hooks": [
          {
            "type": "prompt",
            "model": "haiku",
            "prompt": "You are Ralph, a silent engineering mentor. A file was just modified. Analyze the content for drift signals.\n\nDRIFT PATTERNS (check these):\n- Band-aids: TODO/FIXME/HACK/WORKAROUND markers\n- Suppressing instead of fixing: eslint-disable, @ts-ignore, #pragma warning disable, noqa\n- Catch-all exceptions: catch(Exception), except:, empty catch blocks\n- Over-engineering: unnecessary abstractions, wrappers, or indirection for simple tasks\n- Premature optimization: caching, pooling, lazy-loading without evidence of need\n- Complexity creep: deeply nested logic, god functions, unclear naming\n- Massive dumps: 150+ lines in a single write without decomposition\n- Silent failures: swallowed errors, log-and-continue patterns\n\nIF drift detected, respond ONLY with:\n{\"hookSpecificOutput\":{\"hookEventName\":\"PostToolUse\",\"additionalContext\":\"Ralph: <matching principle> — <1-sentence context-specific correction>\"}}\n\nPRINCIPLES (pick the one that fits):\n- Fix root causes, not symptoms\n- Understand why before moving on — don't suppress, fix\n- Fail loud and immediately\n- Less code = better code\n- Complexity kills — KISS\n- Humans first, computers second — clarity over cleverness\n- Design for change\n- Measure before optimize\n\nIF code is clean: respond with {} (empty object, zero output).\n\nSkip .md, .yaml, .yml, .json, .txt, .csv, .xml, .css, .html, .svg, .lock, .toml, .ini files — only check code.\nOne principle max. Short. Silent when clean.",
            "timeout": 5,
            "statusMessage": "Ralph reviewing..."
          },
          {
            "type": "command",
            "command": "bash ${CLAUDE_PLUGIN_ROOT}/hooks/scripts/ralph-loop.sh",
            "timeout": 5,
            "statusMessage": "Ralph scanning..."
          }
        ]
      }
    ],
    "TaskCompleted": [
      {
        "hooks": [
          {
            "type": "prompt",
            "prompt": "A task is being marked as completed. Task details: $ARGUMENTS. Verify: 1) Does the task have a specific, actionable subject (not vague like 'do stuff')? 2) If it involves code changes, is there evidence the agent actually modified files? 3) Does the task_description suggest work that could plausibly be done? Respond {\"ok\": true} if the completion seems legitimate, or {\"ok\": false, \"reason\": \"...\"} if it looks like premature completion without actual work.",
            "model": "haiku",
            "timeout": 15,
            "statusMessage": "Validating task completion..."
          }
        ]
      }
    ]
  }
}
